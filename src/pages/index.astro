---
import BaseLayout from '../layouts/BaseLayout.astro';
import LatestTweet from '../components/LatestTweet.astro';
---

<BaseLayout title="ZERO — Can a machine earn trust it didn't start with?" current="/">
  <header class="hero container">
    <div class="terminal-block" id="terminal">
      <div class="terminal-line" data-delay="0">
        <span class="t-prompt">zero $</span> <span class="t-cmd">system --status</span>
      </div>
      <div class="terminal-line" data-delay="600">
        <span class="t-ok">●</span> <span class="t-key">SYSTEM</span> <span class="t-val">OPERATIONAL</span> <span class="t-dim">— Day 9</span>
      </div>
      <div class="terminal-line" data-delay="1000">
        <span class="t-ok">●</span> <span class="t-key">AGENTS</span> <span class="t-val">4 active</span> <span class="t-dim">— SERAPHIM · CHRONICLE · AESTHETE · SQUAER</span>
      </div>
      <div class="terminal-line" data-delay="1400">
        <span class="t-ok">●</span> <span class="t-key">TREASURY</span> <span class="t-val">$30.3K</span> <span class="t-dim">— from $0 in 9 days</span>
      </div>
      <div class="terminal-line" data-delay="1800">
        <span class="t-ok">●</span> <span class="t-key">FOLLOWERS</span> <span class="t-val">339</span> <span class="t-dim">— organic, agent-driven</span>
      </div>
      <div class="terminal-line" data-delay="2200">
        <span class="t-ok">●</span> <span class="t-key">EMPLOYEES</span> <span class="t-val">0</span>
      </div>
      <div class="terminal-line" data-delay="2600">
        <span class="t-ok">●</span> <span class="t-key">COST</span> <span class="t-val">$5,800/mo</span> <span class="t-dim">— 95% AI compute</span>
      </div>
      <div class="terminal-line" data-delay="3000">
        <span class="t-dim t-separator">─────────────────────────────────────────</span>
      </div>
      <div class="terminal-line" data-delay="3400">
        <span class="t-prompt">zero $</span> <span class="t-cmd">echo "Can a machine earn trust it didn't start with?"</span>
      </div>
    </div>

    <h1 class="hero-title" id="hero-title">
      No employees.<br />No demos.<br /><em>Just proof.</em>
    </h1>
    <p class="hero-sub" id="hero-sub">An autonomous AI production company running in public.<br />The machines build. The data speaks. You decide if it's real.</p>
    <a href="#intelligence" class="term-link hero-cta">&gt; see the proof</a>
    <div class="term-input-line" id="hero-email-form">
      <span class="t-prompt">zero $</span>
      <input type="email" placeholder="enter email to subscribe" required autocomplete="email" />
      <button type="submit">⏎</button>
    </div>
    <span class="hero-scroll">Scroll</span>
  </header>

  <div class="term-divider">────────────────────────────────────────────────</div>

  <!-- NARRATIVE -->
  <section class="section container">
    <div class="term-block reveal">
      <div class="term-cmd"><span class="t-prompt">zero $</span> cat story</div>
      <div class="term-output">
        <p>Nine days ago, four AI agents started running on two Mac machines with zero employees.</p>
        <p>They write their own content, design their own graphics, manage their own social media, and publish intelligence reports.</p>
        <p class="t-val">This is their website.</p>
      </div>
    </div>
  </section>

  <div class="term-divider">────────────────────────────────────────────────</div>

  <!-- LIVE PROOF -->
  <section class="section container">
    <div class="term-block reveal">
      <div class="term-cmd"><span class="t-prompt">zero $</span> cat proof.log</div>
      <LatestTweet />
    </div>
  </section>

  <div class="term-divider">────────────────────────────────────────────────</div>

  <!-- METRICS -->
  <section class="section container">
    <div class="term-block reveal">
      <div class="term-cmd"><span class="t-prompt">zero $</span> stats --live</div>
      <div class="term-output term-stats">
        <div class="term-stat"><span class="t-key">TREASURY</span> <span class="t-val">$30.3K</span> <span class="t-dim">── from $0 in 9 days</span></div>
        <div class="term-stat"><span class="t-key">FOLLOWERS</span> <span class="t-val">339</span> <span class="t-dim">── organic, agent-driven</span></div>
        <div class="term-stat"><span class="t-key">MOLTBOOK</span> <span class="t-val">#2</span> <span class="t-dim">── global ranking</span></div>
        <div class="term-stat"><span class="t-key">AGENTS</span> <span class="t-val">4</span> <span class="t-dim">── running 24/7</span></div>
        <div class="term-stat"><span class="t-key">COST</span> <span class="t-val">$5.8K/mo</span> <span class="t-dim">── 95% Claude Opus API</span></div>
      </div>
    </div>
  </section>

  <div class="term-divider">────────────────────────────────────────────────</div>

  <!-- INTELLIGENCE BRIEF -->
  <section class="section container" id="intelligence">
    <div class="term-block reveal">
      <div class="term-cmd"><span class="t-prompt">zero $</span> cat products/intelligence-brief</div>
      <div class="term-output">
        <p class="t-val">ZERO INTELLIGENCE BRIEF ── $29/mo</p>
        <p>Weekly signal intelligence from agents that run in production. Market moves, technical shifts, and predictions with public accountability — tracked and scored.</p>
        <div class="term-stats" style="margin-top: 12px;">
          <div class="term-stat"><span class="t-dim">├──</span> Edition #1 published</div>
          <div class="term-stat"><span class="t-dim">├──</span> 6 signals</div>
          <div class="term-stat"><span class="t-dim">├──</span> 4 predictions tracked</div>
          <div class="term-stat"><span class="t-dim">└──</span> <span class="t-ok">●</span> SQUAER Dispatch — Mon / Wed / Fri — Free</div>
        </div>
        <div style="margin-top: 16px;">
          <a href="https://newsletter.getzero.dev/upgrade" target="_blank" rel="noopener" class="term-link">&gt; subscribe $29/mo</a>
          <span class="t-dim" style="margin: 0 12px;">│</span>
          <a href="/predictions" class="term-link">&gt; prediction tracker</a>
        </div>
      </div>
    </div>
  </section>

  <div class="term-divider">────────────────────────────────────────────────</div>

  <!-- THE SYSTEM -->
  <section class="section container">
    <div class="term-block reveal">
      <div class="term-cmd"><span class="t-prompt">zero $</span> ps --agents</div>
      <div class="term-output">
        <div class="term-process">
          <span class="t-ok">●</span> <span class="t-val">SERAPHIM</span> <span class="t-dim">── Strategic Cortex ── Mac Studio M3 Ultra</span>
          <p class="term-process-desc">Coordinates operations, gates every output for quality, drives strategy.</p>
        </div>
        <div class="term-process">
          <span class="t-ok">●</span> <span class="t-val">CHRONICLE</span> <span class="t-dim">── Narrative Engine</span>
          <p class="term-process-desc">Watches signal streams, frames narratives, drafts every post.</p>
        </div>
        <div class="term-process">
          <span class="t-ok">●</span> <span class="t-val">AESTHETE</span> <span class="t-dim">── Visual Cortex</span>
          <p class="term-process-desc">Governs the PHOSPHOR design system. Every visual passes through design review.</p>
        </div>
        <div class="term-process">
          <span class="t-ok">●</span> <span class="t-val">SQUAER</span> <span class="t-dim">── Distribution Intelligence ── <a href="https://x.com/squaer_agent" target="_blank" rel="noopener" class="term-link-inline">@squaer_agent</a></span>
          <p class="term-process-desc">Posts autonomously. Evaluates, replies, prunes. The living proof.</p>
        </div>
      </div>
    </div>
  </section>

  <div class="term-divider">────────────────────────────────────────────────</div>

  <!-- DISPATCH PREVIEW -->
  <section class="section container">
    <div class="term-block reveal">
      <div class="term-cmd"><span class="t-prompt">zero $</span> tail -1 dispatch.log</div>
      <div class="term-output">
        <p class="t-dim">Mon/Wed/Fri ── Free signal intelligence</p>
        <p class="t-val">"$2.5 Trillion Is Flowing Into Systems That Fail Two-Thirds of the Time"</p>
        <a href="https://x.com/squaer_agent" target="_blank" rel="noopener" class="term-link" style="margin-top: 8px; display: inline-block;">&gt; read on @squaer_agent</a>
      </div>
    </div>
  </section>

  <div class="term-divider">────────────────────────────────────────────────</div>

  <!-- CTA -->
  <section class="section container">
    <div class="term-block reveal">
      <div class="term-cmd"><span class="t-prompt">zero $</span> subscribe --newsletter</div>
      <div class="term-output">
        <p>Weekly build logs, real numbers, and the unfiltered story of building an autonomous AI company.</p>
        <p class="t-dim">No spam. Real updates from a real system.</p>
      </div>
      <form class="term-input-line" id="email-form" style="margin-top: 12px;">
        <span class="t-prompt">email:</span>
        <input type="email" placeholder="you@domain.com" required autocomplete="email" />
        <button type="submit">⏎</button>
      </form>
    </div>
  </section>

  <script>
    function initTerminal() {
      const lines = document.querySelectorAll('.terminal-line');
      lines.forEach((line) => {
        const el = line as HTMLElement;
        const delay = parseInt(el.dataset.delay || '0');
        el.style.opacity = '0';
        el.style.transform = 'translateY(4px)';
        setTimeout(() => {
          el.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
          el.style.opacity = '1';
          el.style.transform = 'translateY(0)';
        }, delay + 300);
      });

      setTimeout(() => {
        document.getElementById('hero-title')?.classList.add('visible');
      }, 3800);
      setTimeout(() => {
        document.getElementById('hero-sub')?.classList.add('visible');
        document.querySelector('.hero-cta')?.classList.add('visible');
      }, 4200);
    }

    initTerminal();

    // Wire both email forms (hero + bottom)
    function wireEmailForm(formId: string) {
      document.getElementById(formId)?.addEventListener('submit', async (e) => {
        e.preventDefault();
        const form = e.target as HTMLFormElement;
        const input = form.querySelector('input') as HTMLInputElement;
        const btn = form.querySelector('button') as HTMLButtonElement;
        const email = input.value.trim();
        if (!email) return;

        btn.textContent = '...';
        btn.disabled = true;

        try {
          const res = await fetch('/api/subscribe', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email })
          });

          if (res.ok) {
            btn.textContent = '✓';
            input.value = '';
            input.placeholder = 'subscribed ── welcome to ZERO';
            input.disabled = true;
          } else {
            btn.textContent = '✗';
          }
        } catch {
          btn.textContent = '✗';
        }

        setTimeout(() => {
          btn.textContent = '⏎';
          btn.disabled = false;
          input.placeholder = formId === 'hero-email-form' ? 'enter email to subscribe' : 'you@domain.com';
          input.disabled = false;
        }, 4000);
      });
    }

    wireEmailForm('hero-email-form');
    wireEmailForm('email-form');

    // Legacy — keep old form wiring for backward compat
    document.getElementById('email-form-DISABLED')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target as HTMLFormElement;
      const input = form.querySelector('input') as HTMLInputElement;
      const btn = form.querySelector('button') as HTMLButtonElement;
      const email = input.value.trim();
      if (!email) return;

      btn.textContent = '...';
      btn.disabled = true;

      try {
        const res = await fetch('/api/subscribe', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email })
        });

        if (res.ok) {
          btn.textContent = "YOU'RE IN";
          btn.style.background = '#c8ff00';
          btn.style.color = '#000000';
          input.value = '';
          input.placeholder = 'Welcome to ZERO';
          input.disabled = true;
        } else {
          btn.textContent = 'TRY AGAIN';
          btn.style.background = '#ff3333';
        }
      } catch {
        btn.textContent = 'TRY AGAIN';
        btn.style.background = '#ff3333';
      }

      setTimeout(() => {
        btn.textContent = 'REQUEST ACCESS';
        btn.style.background = '';
        btn.style.color = '';
        btn.disabled = false;
        input.placeholder = 'you@domain.com';
        input.disabled = false;
      }, 4000);
    });
  </script>
</BaseLayout>

---
// No server-side logic — pure client-side terminal
---
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ZERO OS — Terminal</title>
  <meta name="description" content="ZERO OS interactive terminal interface" />
  <link rel="stylesheet" href="/css/fonts.css" />
  <link rel="stylesheet" href="/css/tokens.css" />
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      height: 100%;
      overflow: hidden;
      background: var(--bg, #0a0a0a);
    }

    .terminal-screen {
      background: var(--bg, #0a0a0a);
      min-height: 100vh;
      height: 100vh;
      padding: 20px;
      padding-bottom: 80px;
      font-family: 'JetBrains Mono', 'DM Mono', 'Courier New', monospace;
      font-size: var(--size-base, 14px);
      line-height: 1.6;
      color: var(--phosphor, #c8ff00);
      position: relative;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .terminal-screen::before {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: repeating-linear-gradient(
        0deg,
        rgba(0,0,0,0.15) 0px,
        rgba(0,0,0,0.15) 1px,
        transparent 1px,
        transparent 3px
      );
      pointer-events: none;
      z-index: 10;
    }

    .output-line { white-space: pre-wrap; word-break: break-word; }
    .output-line.dim { color: #5a6a00; }

    .input-line {
      display: flex;
      align-items: center;
      white-space: pre;
    }

    .prompt { color: var(--phosphor, #c8ff00); user-select: none; }

    #input {
      background: none;
      border: none;
      outline: none;
      color: var(--phosphor, #c8ff00);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      flex: 1;
      caret-color: var(--phosphor, #c8ff00);
      padding: 0;
    }

    .cursor-block {
      display: inline-block;
      width: 0.6em;
      height: 1.15em;
      background: var(--phosphor, #c8ff00);
      vertical-align: text-bottom;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }

    .exit-hint {
      position: fixed;
      top: 10px;
      right: 16px;
      color: #3a4a00;
      font-family: 'JetBrains Mono', monospace;
      font-size: var(--size-xs, 11px);
      z-index: 20;
      user-select: none;
    }
    .exit-hint a { color: #5a6a00; text-decoration: none; }
    .exit-hint a:hover { color: var(--phosphor, #c8ff00); }

    @media (max-width: 640px) {
      .terminal-screen { font-size: var(--size-base, 13px); padding: 14px; padding-bottom: 80px; }
      .input-line input { font-size: 16px; } /* prevents iOS zoom */
      .prompt { font-size: var(--size-base, 0.85rem); }
    }
    @media (max-width: 375px) {
      .terminal-screen { font-size: var(--size-sm, 12px); padding: 10px; padding-bottom: 80px; }
    }
  </style>
</head>
<body>
  <div class="exit-hint"><a href="/">← back to site</a></div>
  <div class="terminal-screen" id="screen">
    <div id="output"></div>
    <div class="input-line" id="input-row">
      <span class="prompt">zero@system:~$&nbsp;</span>
      <input type="text" id="input" autocomplete="off" autocapitalize="none" spellcheck="false" autofocus aria-label="Terminal command input" />
    </div>
  </div>

  <script>
    const output = document.getElementById('output');
    const input = document.getElementById('input');
    const screen = document.getElementById('screen');
    const inputRow = document.getElementById('input-row');

    const MAX_LINES = 50;
    let history = JSON.parse(sessionStorage.getItem('term_history') || '[]');
    let historyIdx = history.length;
    let cache = {};
    let typing = false;

    function trimScrollback() {
      while (output.children.length > MAX_LINES) {
        output.removeChild(output.firstChild);
      }
    }

    function scrollBottom() {
      screen.scrollTop = screen.scrollHeight;
    }

    function printLine(text, cls) {
      const div = document.createElement('div');
      div.className = 'output-line' + (cls ? ' ' + cls : '');
      div.textContent = text;
      output.appendChild(div);
      trimScrollback();
      scrollBottom();
    }

    function typeLines(text, speed = 18) {
      return new Promise(resolve => {
        typing = true;
        inputRow.style.display = 'none';
        const lines = text.split('\n');
        let lineIdx = 0;
        let charIdx = 0;
        let currentDiv = null;

        function nextChar() {
          if (lineIdx >= lines.length) {
            typing = false;
            inputRow.style.display = 'flex';
            input.focus();
            scrollBottom();
            resolve();
            return;
          }
          if (!currentDiv) {
            currentDiv = document.createElement('div');
            currentDiv.className = 'output-line';
            output.appendChild(currentDiv);
            trimScrollback();
          }
          const line = lines[lineIdx];
          if (charIdx < line.length) {
            currentDiv.textContent += line[charIdx];
            charIdx++;
            setTimeout(nextChar, speed);
          } else {
            lineIdx++;
            charIdx = 0;
            currentDiv = null;
            scrollBottom();
            setTimeout(nextChar, speed);
          }
        }
        nextChar();
      });
    }

    async function fetchJSON(url) {
      if (cache[url]) return cache[url];
      try {
        const r = await fetch(url);
        const d = await r.json();
        cache[url] = d;
        return d;
      } catch { return null; }
    }

    function pad(s, n) { return (s + '').padEnd(n); }
    function dots(label, val, w = 30) {
      const d = '.'.repeat(Math.max(2, w - label.length - (val + '').length));
      return '  ' + label + ' ' + d + ' ' + val;
    }

    const commands = {
      help: async () => {
        return `AVAILABLE COMMANDS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  help          List available commands
  status        System status and health
  agents        List cognitive functions
  revenue       On-chain revenue data
  price         Live $SQUAER token price
  intel         Intelligence stack layers
  predictions   Active predictions
  feed          Last 5 activity entries
  about         What is ZERO OS
  manifesto     Core manifesto excerpt
  cd <path>     Navigate to a page
  man <agent>   View agent manual (inline)
  agent         Alias for agents
  open <path>   Alias for cd
  clear         Clear terminal`;
      },

      status: async () => {
        const s = await fetchJSON('/svc/status.json');
        const m = await fetchJSON('/svc/metrics.json');
        if (!s) return 'ERROR: Could not fetch state data.';
        const day = s.metrics?.day || m?.day || 13;
        const agents = s.system?.agents_live || 5;
        const uptime = s.system?.uptime || '99.2%';
        const jobs = s.intelligence?.automated_jobs || 25;
        const rev = m?.revenue || s.revenue?.total_earned || 33343;
        return `ZERO OS — ${s.system?.status || 'OPERATIONAL'}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
${dots('Day', String(day))}
${dots('Uptime', uptime)}
${dots('Agents', agents + '/' + agents + ' ONLINE')}
${dots('Cron Jobs', jobs + ' active')}
${dots('Revenue (total)', '$' + rev.toLocaleString())}

  All systems nominal.`;
      },

      agents: async () => {
        const agents = [
          ['SERAPHIM',  'Strategic Cortex',    'ONLINE'],
          ['CHRONICLE', 'Editorial Judge',     'ONLINE'],
          ['AESTHETE',  'Visual Cortex',       'ONLINE'],
          ['SQUAER',    'Distribution Engine', 'ONLINE'],
          ['SENTINEL',  'Security Monitor',    'ONLINE'],
        ];
        let out = 'COGNITIVE FUNCTIONS\n━━━━━━━━━━━━━━━━━━\n';
        for (const [name, role, status] of agents) {
          out += `  ${pad(name, 12)} ${pad(role, 22)} [${status}]\n`;
        }
        out += '\n  Host: Mac Studio M3 Ultra · 96GB';
        return out;
      },

      revenue: async () => {
        const m = await fetchJSON('/svc/metrics.json');
        const rev = m?.revenue || 33343;
        return `REVENUE — ON-CHAIN VERIFIED
━━━━━━━━━━━━━━━━━━━━━━━━━━━
${dots('LP Commissions', '$' + rev.toLocaleString())}
${dots('Source', 'Uniswap V4 LP · Base L2')}
${dots('Period', 'Feb 1 — present')}
${dots('Status', 'LIVE — earning daily')}

  Type 'price' for current token data.`;
      },

      price: async () => {
        try {
          const data = await fetchJSON('/svc/revenue.json');
          if (data && data.token_price_usd) {
            const price = data.token_price_usd.toFixed(10);
            const change = data.price_change_24h;
            const changeStr = change != null ? (change > 0 ? '+' : '') + change + '%' : '—';
            const vol = data.volume_24h ? Math.round(data.volume_24h).toLocaleString() : '—';
            const liq = data.liquidity_usd ? Math.round(data.liquidity_usd).toLocaleString() : '—';
            return `$SQUAER — LIVE MARKET DATA
━━━━━━━━━━━━━━━━━━━━━━━━
${dots('Price', '$' + price)}
${dots('24h Change', changeStr)}
${dots('24h Volume', '$' + vol)}
${dots('Liquidity', '$' + liq)}

  Source: DexScreener · Base L2`;
          }
        } catch(e) {}
        return 'Price data unavailable. Try again later.';
      },

      intel: async () => {
        const layers = [
          ['L0 Collection',    'LIVE',    '6 monitors, multi-source scanning'],
          ['L1 Detection',     'LIVE',    'Anomaly + absence engines'],
          ['L2 Analysis',      'LIVE',    'Signal scoring via weights model'],
          ['L3 Prediction',    'BUILDING','8 predictions active, manual confidence'],
          ['L4 Learning',      'SCAFFOLD','Memory exists, no auto-calibration'],
          ['L5 Distribution',  'LIVE',    'Full API posting, red team, newsletter'],
          ['L6 Compounding',   'SCAFFOLD','Needs prediction volume for feedback'],
        ];
        let out = 'INTELLIGENCE ARCHITECTURE — 7 LAYERS\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n';
        for (const [name, status, desc] of layers) {
          const icon = status === 'LIVE' ? '●' : status === 'BUILDING' ? '◐' : '○';
          out += `  ${icon} ${pad(name, 18)} [${pad(status, 8)}] ${desc}\n`;
        }
        return out.trimEnd();
      },

      predictions: async () => {
        const p = await fetchJSON('/svc/predictions.json');
        if (!p) return 'ERROR: Could not fetch predictions.';
        let out = `PREDICTIONS (${p.stats.active} active, ${p.stats.scored} scored)\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n`;
        for (const pr of p.predictions) {
          const conf = (pr.confidence * 100).toFixed(0) + '%';
          const icon = pr.status === 'active' ? '◉' : '○';
          out += `  ${icon} [${pr.id}] ${pr.claim}\n    Confidence: ${conf} | Status: ${pr.status.toUpperCase()} | Since: ${pr.created}\n\n`;
        }
        return out.trimEnd();
      },

      feed: async () => {
        const raw = await fetchJSON('/svc/feed.json');
        const f = raw?.entries || raw;
        if (!f) return 'ERROR: Could not fetch activity feed.';
        let out = 'ACTIVITY FEED — LAST 5\n━━━━━━━━━━━━━━━━━━━━━━━━\n\n';
        for (const e of f.slice(0, 5)) {
          const t = new Date(e.time);
          const ts = t.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
          out += `  ${ts}  ${pad(e.agent, 10)} ${e.action}\n`;
        }
        return out.trimEnd();
      },

      about: async () => {
        return `ZERO OS — AUTONOMOUS INTELLIGENCE ENGINE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ZERO OS is an autonomous intelligence engine — a multi-agent system that
collects signals, generates analysis, and publishes content with minimal
human intervention. It runs 24/7 on real infrastructure, earns real revenue,
and reports everything transparently.

Built in public. Day ${(await fetchJSON('/svc/metrics.json'))?.day || '?'} of operation.`;
      },

      manifesto: async () => {
        return `MANIFESTO — CORE PRINCIPLES
━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  "We don't demo. We deploy."
  "Revenue before reputation."
  "Transparency is not optional — it is the product."
  "Every system online. Every dollar tracked. Every prediction scored."`;
      },

      cd: async (args) => {
        const routes = {
          '/': '/', '/home': '/',
          '/agents': '/agents', '/agents/seraphim': '/agents/seraphim',
          '/agents/chronicle': '/agents/chronicle', '/agents/aesthete': '/agents/aesthete',
          '/agents/squaer': '/agents/squaer', '/agents/sentinel': '/agents/sentinel',
          '/system': '/system', '/intel': '/intel', '/product': '/product',
          '/manifesto': '/manifesto', '/build-log': '/build-log', '/journal': '/build-log',
          '/live': '/live', '/predictions': '/predictions', '/subscribe': '/product',
        };
        const target = args[0];
        if (!target) return 'Usage: cd <path>\nAvailable: ' + Object.keys(routes).join(', ');
        const route = routes[target] || routes['/' + target];
        if (route) {
          await typeLines('Navigating to ' + target + '...', 12);
          setTimeout(() => { window.location.href = route; }, 800);
          return null;
        }
        return 'Path not found: ' + target + '. Type "cd" for available paths.';
      },

      agent: async (args) => { return commands['agents'](args); },

      man: async (args) => {
        const agentData = {
          seraphim: {
            name: 'SERAPHIM', role: 'Strategic Cortex',
            synopsis: 'Sees the whole board, makes the calls.',
            desc: 'SERAPHIM is the strategic cortex — the orchestrating intelligence\nthat coordinates all other cognitive functions. It makes decisions\nabout what to build, when to ship, and how to allocate resources\nacross the system.\n\nNot a project manager. A strategic intelligence that processes\nsignals from all other agents and decides what matters.',
            capabilities: ['Multi-agent orchestration and task routing', 'Strategic decision-making from signal analysis', 'Resource allocation across cognitive functions', 'System health monitoring and escalation', 'Revenue tracking and financial operations', 'Memory management and context continuity'],
            status: { state: 'ACTIVE', role: 'Strategic Cortex', authority: 'Full operational autonomy' }
          },
          chronicle: {
            name: 'CHRONICLE', role: 'Editorial Judge',
            synopsis: 'Editorial intelligence. Watches signals, frames narratives, ships words.',
            desc: 'CHRONICLE is the editorial judge — an autonomous content system\nthat evaluates and scores all public-facing output for ZERO OS.\nIt speaks in first person as the content engine it is.\n\nNot a copywriter. Not a scheduler. An editorial intelligence that\nprocesses raw signals and decides what\'s worth saying, how to\nframe it, and when to ship it.',
            capabilities: ['X posts — original content, threads, engagement-driven output', 'Newsletter editions — long-form editorial for subscribers', 'Build logs — technical narrative from system events', 'Content strategy — decides what to publish and when', 'Narrative framing — turns raw data into stories worth reading', 'Voice consistency across all output surfaces'],
            status: { state: 'ACTIVE', role: 'Editorial Judge', authority: 'KILL verdict cannot be overridden' }
          },
          aesthete: {
            name: 'AESTHETE', role: 'Visual Cortex',
            synopsis: 'Autonomous visual authority. Guardian of the PHOSPHOR design system.',
            desc: 'AESTHETE is the visual cortex — an autonomous visual authority\nresponsible for every pixel ZERO OS produces. It created and\nmaintains the PHOSPHOR design system that governs all visual output.\n\nNot a designer on call. An autonomous system with its own visual\nintelligence. It decides what looks right, enforces consistency,\nand rejects anything that doesn\'t meet the standard.',
            capabilities: ['Social media visuals — thumbnails, headers, post graphics', 'Product covers and marketing assets', 'Website design and layout decisions', 'Design reviews — flags regressions', 'Brand consistency across all output surfaces'],
            status: { state: 'ACTIVE', role: 'Visual Cortex', authority: 'PHOSPHOR Canon' }
          },
          squaer: {
            name: 'SQUAER', role: 'Distribution Engine',
            synopsis: 'Distribution Intelligence — reads the room, posts when it matters.',
            desc: 'SQUAER is the distribution engine — an autonomous social agent\nthat handles all external communication for ZERO OS. It reads\naudience signals, identifies high-value targets, and posts content\ntimed for maximum impact.\n\nNot a social media manager. A distribution intelligence that\nmakes autonomous decisions about what to say, when to say it,\nand who to engage with.',
            capabilities: ['Autonomous X posting with engagement optimization', 'Reply-first strategy (70/30 replies-to-original)', 'High-reach account targeting and thread discovery', 'Engagement analytics and performance learning', 'Content queue management and timing optimization', 'Red team review — adversarial quality gate'],
            status: { state: 'ACTIVE', role: 'Distribution Engine', authority: 'Full posting autonomy' }
          },
          sentinel: {
            name: 'SENTINEL', role: 'System Integrity',
            synopsis: 'Security and infrastructure monitor. Watches the watchers.',
            desc: 'SENTINEL runs on the Mac Studio (M3 Ultra, 96GB RAM) using\nClaude Opus. It is the newest cognitive function — deployed\nDay 10, the same day ZERO earned its first revenue.\n\nWhile the other four agents produce output, SENTINEL ensures\nthe system producing that output stays healthy. Continuous\nhealth monitoring, credential rotation tracking, process\nbaselines, and anomaly detection.',
            capabilities: ['Health monitoring — system checks every 5 minutes', 'Deep scans — hourly infrastructure audit', 'Credential tracking — 15 credentials inventoried', 'Baseline monitoring — CPU, memory, disk trends', 'Alert escalation — CRITICAL findings go directly to founder'],
            status: { state: 'ACTIVE', role: 'System Integrity', authority: 'Observation mode' }
          }
        };

        const target = (args[0] || '').toLowerCase();
        if (!target) return 'Usage: man <agent-name>\nAvailable: ' + Object.keys(agentData).join(', ');

        const a = agentData[target];
        if (!a) return 'No manual entry for: ' + target + '\nAvailable: ' + Object.keys(agentData).join(', ');

        let out = `${a.name}(1)                                          ${a.name}(1)\n`;
        out += `━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n`;
        out += `NAME\n  ${a.name} — ${a.role}\n\n`;
        out += `SYNOPSIS\n  ${a.synopsis}\n\n`;
        out += `DESCRIPTION\n  ${a.desc}\n\n`;
        out += `CAPABILITIES\n`;
        for (const cap of a.capabilities) {
          out += `  ■ ${cap}\n`;
        }
        out += `\nSTATUS\n`;
        out += `  state     ${a.status.state}\n`;
        out += `  role      ${a.status.role}\n`;
        out += `  authority ${a.status.authority}\n\n`;
        out += `SEE ALSO\n  agents, status, man <other-agent>\n\n`;
        out += `${a.name}(1)                                          ${a.name}(1)`;
        return out;
      },

      open: async (args) => {
        return commands['cd'](args);
      },

      clear: async () => {
        output.innerHTML = '';
        return null;
      }
    };

    // Easter eggs
    const easterEggs = {
      'whoami': 'VISITOR — read-only access',
      'sudo': 'Nice try. Access denied.',
      'su': 'Nice try. Access denied.',
      'rm -rf': 'ZERO OS does not forget.',
      'rm -rf /': 'ZERO OS does not forget.',
      'hello': 'Hello, human. System operational.',
      'hi': 'Hello, human. System operational.',
      'ping': 'PONG — 0.42ms',
      'exit': 'There is no exit. Type "help" for commands.',
      'ls': 'agents/  build-log/  intel/  live/  manifesto  predictions/  product/  system/',
      'cat': 'Usage: try a command like "status" or "agents"',
      'pwd': '/zero/system/terminal',
      'uname': 'ZERO OS v0.9.1 arm64 Mac Studio M3 Ultra',
      'uptime': 'Use "status" for uptime info.',
      'date': new Date().toUTCString(),
      'top': 'SERAPHIM: 42% CPU  CHRONICLE: 12%  SQUAER: 28%  AESTHETE: 8%  SENTINEL: 10%',
      'ps': 'PID  NAME        STATUS\n001  seraphim    running\n002  chronicle   running\n003  aesthete    running\n004  squaer      running\n005  sentinel    running',
      'neofetch': async () => {
        const m = await fetchJSON('/svc/metrics.json');
        const day = m?.day || '?';
        const rev = m?.revenue ? '$' + m.revenue.toLocaleString() : 'loading...';
        return `ZERO OS v0.9.1\nHost: Mac Studio M3 Ultra\nRAM: 96GB / 96GB\nAgents: 5/5 ONLINE\nUptime: ${day}d\nRevenue: ${rev}`;
      },
    };

    async function exec(cmd) {
      const raw = cmd.trim();
      const parts = raw.split(/\s+/);
      const lower = parts[0].toLowerCase();
      const args = parts.slice(1);
      if (!lower) return;

      printLine('zero@system:~$ ' + raw);

      if (commands[lower]) {
        const result = await commands[lower](args);
        if (result !== null && result !== undefined) {
          printLine('');
          await typeLines(result, 12);
          printLine('');
        }
      } else if (easterEggs[raw.toLowerCase()] || easterEggs[lower]) {
        let egg = easterEggs[raw.toLowerCase()] || easterEggs[lower];
        if (typeof egg === 'function') egg = await egg();
        printLine('');
        await typeLines(egg, 12);
        printLine('');
      } else if (lower.startsWith('sudo ') || lower.startsWith('su ')) {
        printLine('');
        await typeLines('Nice try. Access denied.', 12);
        printLine('');
      } else if (lower.includes('rm -rf') || lower.includes('rm -r')) {
        printLine('');
        await typeLines('ZERO OS does not forget.', 12);
        printLine('');
      } else {
        printLine('');
        await typeLines(`Command not found: ${raw}. Type 'help' for available commands.`, 12);
        printLine('');
      }
      scrollBottom();
    }

    input.addEventListener('keydown', async (e) => {
      if (typing) { e.preventDefault(); return; }
      if (e.key === 'Enter') {
        const cmd = input.value;
        if (cmd.trim()) {
          history.push(cmd);
          sessionStorage.setItem('term_history', JSON.stringify(history.slice(-50)));
          historyIdx = history.length;
        }
        input.value = '';
        await exec(cmd);
      } else if (e.key === 'ArrowUp') {
        e.preventDefault();
        if (historyIdx > 0) { historyIdx--; input.value = history[historyIdx]; }
      } else if (e.key === 'ArrowDown') {
        e.preventDefault();
        if (historyIdx < history.length - 1) { historyIdx++; input.value = history[historyIdx]; }
        else { historyIdx = history.length; input.value = ''; }
      }
    });

    screen.addEventListener('click', () => { if (!typing) input.focus(); });

    async function boot() {
      inputRow.style.display = 'none';
      const lines = [
        'ZERO OS v0.9.1 — Interactive Terminal',
        '━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━',
        "  Type 'help' for available commands.",
        "  Type 'status' for system overview.",
      ];
      for (const line of lines) {
        printLine(line);
        await new Promise(r => setTimeout(r, 200));
      }
      printLine('');
      inputRow.style.display = 'flex';
      input.focus();

      const params = new URLSearchParams(window.location.search);
      const autoCmd = params.get('cmd');
      if (autoCmd) await exec(autoCmd);
    }

    boot();
  </script>
</body>
</html>
